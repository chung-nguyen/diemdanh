(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]||[]).push([["b1aa1aca"],{"0830b990":function(e,a,t){t.d(a,"__esModule",{value:!0}),t.e(a,{default:function(){return ec;}});var l=t("777fffbe"),n=t("852bbaa9"),d=t("1c0135da"),r=t("db1ae84d"),s=l._(r),i=t("b7441d7d"),c=n._(i),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM514.1 580.1l-61.8-102.4c-2.2-3.6-6.1-5.8-10.3-5.8h-38.4c-2.3 0-4.5.6-6.4 1.9-5.6 3.5-7.3 10.9-3.7 16.6l82.3 130.4-83.4 132.8a12.04 12.04 0 0010.2 18.4h34.5c4.2 0 8-2.2 10.2-5.7L510 664.8l62.3 101.4c2.2 3.6 6.1 5.7 10.2 5.7H620c2.3 0 4.5-.7 6.5-1.9 5.6-3.6 7.2-11 3.6-16.6l-84-130.4 85.3-132.5a12.04 12.04 0 00-10.1-18.5h-35.7c-4.2 0-8.1 2.2-10.3 5.8l-61.2 102.3z"}}]},name:"file-excel",theme:"outlined"},u=t("d6ea7181"),h=l._(u),f=c.forwardRef(function(e,a){return c.createElement(h.default,(0,s.default)((0,s.default)({},e),{},{ref:a,icon:o}));}),m=t("d0ded34d"),g=l._(m),p={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M468 128H160c-17.7 0-32 14.3-32 32v308c0 4.4 3.6 8 8 8h332c4.4 0 8-3.6 8-8V136c0-4.4-3.6-8-8-8zm-56 284H192V192h220v220zm-138-74h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm194 210H136c-4.4 0-8 3.6-8 8v308c0 17.7 14.3 32 32 32h308c4.4 0 8-3.6 8-8V556c0-4.4-3.6-8-8-8zm-56 284H192V612h220v220zm-138-74h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm590-630H556c-4.4 0-8 3.6-8 8v332c0 4.4 3.6 8 8 8h332c4.4 0 8-3.6 8-8V160c0-17.7-14.3-32-32-32zm-32 284H612V192h220v220zm-138-74h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm194 210h-48c-4.4 0-8 3.6-8 8v134h-78V556c0-4.4-3.6-8-8-8H556c-4.4 0-8 3.6-8 8v332c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V644h78v102c0 4.4 3.6 8 8 8h190c4.4 0 8-3.6 8-8V556c0-4.4-3.6-8-8-8zM746 832h-48c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zm142 0h-48c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}}]},name:"qrcode",theme:"outlined"},v=c.forwardRef(function(e,a){return c.createElement(h.default,(0,s.default)((0,s.default)({},e),{},{ref:a,icon:p}));}),x=t("ca26ff16"),b=l._(x),j=t("ea4234f3"),y=t("83916a63"),w=t("001c8eca"),C=t("ac95773d"),_=t("c8ea7ff5"),S=l._(_),k=t("9130e84e"),I=l._(k),P=t("58816e9f"),z=l._(P),V=t("f796ae67"),T=l._(V),R=t("99e5d786"),N=l._(R);async function H(e,a){return(0,C.request)(`/guest/${e._id}`,{data:e,method:"PUT",...a||{}});}async function E(e,a){return(0,C.request)("/guest",{data:e,method:"POST",...a||{}});}async function M(e,a){return(0,C.request)("/guest",{data:e,method:"DELETE",...a||{}});}var D=t("b42dddfe"),L=t("ec0a8ea3"),O=t("1edce643"),B=t("d2d23e5a"),Q=l._(B),q=t("c52be1c6"),A=l._(q),$=t("f422d49d"),F=l._($);let U=e=>{let{meeting:a,createModalVisible:t,onSubmit:l,onCancel:n}=e,r=(0,C.useIntl)();return(0,d.jsxs)(O.DrawerForm,{title:r.formatMessage({id:"pages.form.metafields.new",defaultMessage:"Th\xeam kh\xe1ch m\u1EDDi"}),width:600,open:t,onFinish:l,drawerProps:{onClose:n,destroyOnClose:!0},grid:!0,initialValues:{description:"",key:"",namespace:"",value:""},children:[(0,d.jsx)(A.default.Item,{label:"H\u1ED9i ngh\u1ECB",style:{width:"100%"},children:(0,d.jsx)(F.default,{readOnly:!0,value:null==a?void 0:a.name})}),(0,d.jsx)(Q.default,{colProps:{span:24},name:"seat",label:"S\u1ED1 gh\u1EBF"}),(0,d.jsx)(Q.default,{colProps:{span:24},name:"idNumber",label:"S\u1ED1 CCCD"}),(0,d.jsx)(Q.default,{colProps:{span:24},name:"phoneNumber",label:"\u0110i\u1EC7n tho\u1EA1i"}),(0,d.jsx)(Q.default,{colProps:{span:24},name:"email",label:"Email"}),(0,d.jsx)(Q.default,{colProps:{span:24},name:"fullName",label:"T\xean"}),(0,d.jsx)(Q.default,{colProps:{span:24},name:"office",label:"Ch\u1EE9c v\u1EE5"}),(0,d.jsx)(Q.default,{colProps:{span:24},name:"workplace",label:"\u0110\u01A1n v\u1ECB"})]});},K=({meeting:e,onSubmit:a,onCancel:t,updateModalVisible:l,values:n,...r})=>((0,C.useIntl)(),(0,d.jsxs)(O.DrawerForm,{title:[n.fullName,n.idNumber].join(" "),width:600,open:l,onFinish:a,drawerProps:{onClose:t,destroyOnClose:!0},initialValues:n,children:[(0,d.jsx)(A.default.Item,{label:"H\u1ED9i ngh\u1ECB",style:{width:"100%"},children:(0,d.jsx)(F.default,{readOnly:!0,value:null==e?void 0:e.name})}),(0,d.jsx)(Q.default,{colProps:{span:24},name:"seat",label:"S\u1ED1 gh\u1EBF"}),(0,d.jsx)(Q.default,{colProps:{span:24},name:"idNumber",label:"S\u1ED1 CCCD"}),(0,d.jsx)(Q.default,{colProps:{span:24},name:"phoneNumber",label:"\u0110i\u1EC7n tho\u1EA1i"}),(0,d.jsx)(Q.default,{colProps:{span:24},name:"email",label:"Email"}),(0,d.jsx)(Q.default,{colProps:{span:24},name:"fullName",label:"T\xean"}),(0,d.jsx)(Q.default,{colProps:{span:24},name:"office",label:"Ch\u1EE9c v\u1EE5"}),(0,d.jsx)(Q.default,{colProps:{span:24},name:"workplace",label:"\u0110\u01A1n v\u1ECB"})]}));var W=t("6c336637"),G=t("fb0a18f0"),X=l._(G),J=t("25a3214a"),Y=l._(J),Z=t("db2928d6"),ee=l._(Z),ea=t("d09ca83a"),et=l._(ea),el=t("0493cabe");let en=({meetingId:e,onDone:a,onCancel:t,visible:l})=>{(0,C.useIntl)();let n=(0,el.getAccessToken)(),r={name:"file",multiple:!1,action:(0,W.getAPIURL)(`meeting/import-addendum/${e}`),headers:{Authorization:`Bearer ${n}`},onChange(e){let{status:t}=e.file;"uploading"!==t&&console.log(e.file,e.fileList),"done"===t?(z.default.success(`${e.file.name} nh\u{1EAD}p th\xe0nh c\xf4ng.`),a()):"error"===t&&z.default.error(`${e.file.name} nh\u{1EAD}p th\u{1EA5}t b\u{1EA1}i.`);},onDrop(e){console.log("Dropped files",e.dataTransfer.files);}};return(0,d.jsx)(ee.default,{open:l,onOk:t,onCancel:t,children:(0,d.jsxs)(et.default,{...r,children:[(0,d.jsx)("p",{className:"ant-upload-drag-icon",children:(0,d.jsx)(Y.default,{})}),(0,d.jsx)("p",{className:"ant-upload-text",children:"Click ho\u1EB7c k\xe9o file v\xe0o \u0111\xe2y \u0111\u1EC3 nh\u1EADp"}),(0,d.jsx)("p",{className:"ant-upload-hint",children:"B\u1ED5 sung kh\xe1ch m\u1EDDi b\u1EB1ng c\xe1ch nh\u1EADp file Excel."})]})});},ed=async e=>{let a=z.default.loading("\u0110ang x\u1EED l\xfd");try{return await E({...e}),a(),z.default.success("\u0110\xe3 th\xeam th\xe0nh c\xf4ng"),!0;}catch(e){var t,l;return a(),(null===(l=e.response)||void 0===l?void 0:null===(t=l.data)||void 0===t?void 0:t.message)&&e.response.data.message.startsWith("E11000")?z.default.error("Kh\xe1ch m\u1EDDi \u0111\xe3 c\xf3 trong danh s\xe1ch! Vui l\xf2ng ch\u1ECDn kh\xe1ch m\u1EDDi kh\xe1c."):z.default.error("Vui l\xf2ng th\u1EED l\u1EA1i!"),!1;}},er=async(e,a)=>{let t=z.default.loading("\u0110ang x\u1EED l\xfd");try{return await H({...a,...e}),t(),z.default.success("C\u1EADp nh\u1EADt th\xe0nh c\xf4ng"),!0;}catch(e){return t(),z.default.error("Vui l\xf2ng th\u1EED l\u1EA1i!"),!1;}},es=async e=>{let a=z.default.loading("\u0110ang x\u1EED l\xfd");if(!e)return!0;try{return await M({ids:e.map(e=>e._id)}),a(),z.default.success("X\xf3a th\xe0nh c\xf4ng!"),!0;}catch(e){return a(),z.default.error("Vui l\xf2ng th\u1EED l\u1EA1i!"),!1;}},ei=async(e,a,t)=>{let l=z.default.loading("\u0110ang x\u1EED l\xfd");try{return await (0,D.printQRSheet)(e,a,t),l(),z.default.success("\u0110\xe3 x\u1EED l\xfd th\xe0nh c\xf4ng"),!0;}catch(e){return l(),console.error(e),z.default.error("Vui l\xf2ng th\u1EED l\u1EA1i!"),!1;}},ec=()=>{let[e,a]=(0,c.useState)(!1),[t,l]=(0,c.useState)(!1),[n,r]=(0,c.useState)(!1),[s,i]=(0,c.useState)(!1),o=(0,c.useRef)(),[u,h]=(0,c.useState)(),[m,p]=(0,c.useState)([]),[x,_]=(0,c.useState)({width:{show:!1},height:{show:!1},alt:{show:!1}}),{data:k}=(0,C.useQuery)(["check-in-url"],()=>(0,D.getCheckInURL)()),P=String(new URLSearchParams(C.history.location.search).get("id")),z=(0,el.getAccessToken)(),{data:V,isLoading:R}=(0,C.useQuery)(["attendance-list",P],()=>(0,D.getMeeting)(P),{enabled:!!P}),H=[{title:"Gh\u1EBF",dataIndex:"seat",sorter:!0},{title:"T\xean kh\xe1ch m\u1EDDi",dataIndex:"guestId",sorter:!0,render:(e,a)=>{var t;return(0,d.jsxs)(N.default,{children:[(0,d.jsx)(S.default,{src:(0,W.getPhotoURL)((null===(t=a._id)||void 0===t?void 0:t.idNumber)+".jpg"),icon:(0,d.jsx)(b.default,{})}),(0,d.jsx)("a",{onClick:()=>{l(!0),h(a);},children:null==a?void 0:a.fullName})]});}},{title:"Ch\u1EE9c v\u1EE5",dataIndex:"guestId",sorter:!0,render:(e,a)=>null==a?void 0:a.office},{title:"\u0110\u01A1n v\u1ECB",dataIndex:"guestId",sorter:!0,render:(e,a)=>null==a?void 0:a.workplace},{title:"S\u1ED1 \u0111i\u1EC7n tho\u1EA1i",dataIndex:"guestId",sorter:!0,render:(e,a)=>null==a?void 0:a.phoneNumber},{title:"Email",dataIndex:"guestId",sorter:!0,render:(e,a)=>null==a?void 0:a.email},{title:"QR Code",dataIndex:"guestId",sorter:!1,render:(e,a)=>(0,d.jsx)(X.default,{size:256,height:64,style:{height:"auto",maxWidth:"50%",width:"50%"},value:"",viewBox:"0 0 256 256",children:" "})}];return(0,d.jsxs)(y.PageContainer,{loading:R,children:[(0,d.jsx)(w.ProTable,{columnsState:(0,L.tableColumnState)("attendance",x,_),headerTitle:`Danh s\xe1ch Kh\xe1ch m\u{1EDD}i c\u{1EE7}a ${null==V?void 0:V.data.name}`,actionRef:o,rowKey:"_id",search:!1,pagination:{showSizeChanger:!0,showQuickJumper:!0,defaultPageSize:20,pageSizeOptions:[20,50,100,200]},toolBarRender:()=>[(0,d.jsxs)(I.default,{type:"primary",onClick:()=>{a(!0);},children:[(0,d.jsx)(g.default,{})," T\u1EA1o m\u1EDBi"]},"primary"),(0,d.jsxs)(I.default,{type:"default",onClick:()=>r(!0),children:[(0,d.jsx)(f,{})," B\u1ED5 sung t\u1EEB Excel"]},"default"),(0,d.jsxs)(I.default,{type:"default",onClick:()=>ei(P,"QR - "+String(null==V?void 0:V.data.name)+".pdf",z),children:[(0,d.jsx)(v,{})," In QR"]},"default")],request:async(e,a,t)=>{(t=t||{}).meetingId=P;let l={...e,...t};if(a){let e=Object.entries(a)[0];e&&(l.sort=e[0],l.direction=e[1]);}return(0,C.request)("/guest",{method:"GET",params:l});},columns:H,rowSelection:{onChange:(e,a)=>{p(a);}}}),(null==m?void 0:m.length)>0&&(0,d.jsx)(j.FooterToolbar,{extra:(0,d.jsxs)("div",{children:["Selected\xa0",(0,d.jsx)("a",{style:{fontWeight:600},children:m.length}),"\xa0 items"]}),children:(0,d.jsx)(T.default,{title:"Ch\u1EAFc ch\u1EAFn?",onConfirm:async()=>{var e,a;await es(m),p([]),null===(a=o.current)||void 0===a||null===(e=a.reloadAndRest)||void 0===e||e.call(a);},children:(0,d.jsx)(I.default,{children:"X\xf3a nhi\u1EC1u d\xf2ng"})},"delete")}),(0,d.jsx)(U,{meeting:null==V?void 0:V.data,createModalVisible:e,onSubmit:async e=>{(null==V?void 0:V.data._id)&&(e.meetingId=null==V?void 0:V.data._id,await ed(e)&&(a(!1),o.current&&o.current.reload()));},onCancel:()=>{a(!1),h(void 0),i(!1);}}),(0,d.jsx)(K,{meeting:null==V?void 0:V.data,onSubmit:async e=>{await er(e,u)&&(l(!1),h(void 0),i(!1),o.current&&o.current.reload());},onCancel:()=>{l(!1),h(void 0),i(!1);},updateModalVisible:t,values:u||{}}),(0,d.jsx)(en,{meetingId:P,onCancel:()=>{r(!1);},onDone:()=>{var e,a;return null===(a=o.current)||void 0===a?void 0:null===(e=a.reloadAndRest)||void 0===e?void 0:e.call(a);},visible:n})]});};}}]);
//# sourceMappingURL=b1aa1aca-async.eaa0bbb1.js.map